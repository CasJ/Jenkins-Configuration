<?xml version='1.0' encoding='UTF-8'?>
<flow-definition plugin="workflow-job@2.8">
  <actions/>
  <description></description>
  <keepDependencies>false</keepDependencies>
  <properties>
    <org.jenkinsci.plugins.workflow.job.properties.PipelineTriggersJobProperty>
      <triggers/>
    </org.jenkinsci.plugins.workflow.job.properties.PipelineTriggersJobProperty>
  </properties>
  <definition class="org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition" plugin="workflow-cps@2.21">
    <script>
stage &apos;Sandbox&apos;
node(&apos;onmetal-provisioner&apos;) {
    
    def host_ip = &apos;65.61.190.78&apos;
    def resulst
    int index
    String newline = &quot;\n&quot;
    
    // Run the tests and store the results in ~/subunit/before
    //results = sh returnStdout: true, script: &quot;&quot;&quot;
    //ssh -o StrictHostKeyChecking=no root@${host_ip} &apos;&apos;&apos;
    //cd /root/tempest/
    //stream_id=`cat .testrepository/next-stream`
    //ostestr --regex smoke
    //mkdir -p /root/subunit/smoke/
    //cp .testrepository/\$stream_id /root/subunit/smoke/temp
    //&apos;&apos;&apos;
    //&quot;&quot;&quot;
    results = &apos;&apos;&apos;Este es un texto de prueba que puede tener fallas
    ======
    Totals
    ======
    Ran: 104 tests in 236.0000 sec.
     - Passed: 91
     - Skipped: 12
     - Expected Fail: 0
     - Unexpected Success: 0
     - Failed: 10
    Sum of execute time for each test: 922.9890 sec.
    
    ==============
    Worker Balance
    ==============
     - Worker 0 (2 tests) =&gt; 0:03:51.324015
     - Worker 1 (4 tests) =&gt; 0:01:22.819383
     - Worker 2 (5 tests) =&gt; 0:01:41.006022
     - Worker 3 (2 tests) =&gt; 0:01:00.246466
     - Worker 4 (3 tests) =&gt; 0:00:56.784042
    &apos;&apos;&apos;
    println &apos;These are the results generated by the script&apos;
    println results
    
    if (results.contains(&apos;- Failed:&apos;) == true) {
        
        println &apos;Failed tests were found&apos;
        def failures = results.substring(results.indexOf(&apos;- Failed:&apos;) + 10)
        println failures.substring(0,failures.indexOf(newline))
        //println failures
        //failures.substring(0,failures.indexOf(newline))
        //println results.substring(results.indexOf(&apos;- Failed:&apos;) + 10, results.indexOf(newline, results.indexOf(&apos;- Failed:&apos;) + 10))
    } else {
        println &apos;No failures&apos;
    }
    
}
</script>
    <sandbox>true</sandbox>
  </definition>
  <triggers/>
</flow-definition>